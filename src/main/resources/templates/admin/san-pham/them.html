<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="admin/admin-layout :: head('Thêm sản phẩm')"></head>
<body>
<!-- Sidebar -->
<aside th:replace="admin/admin-layout :: sidebar('san-pham')"></aside>

<!-- Main Content -->
<main class="main-content">
    <!-- Header -->
    <div th:replace="admin/admin-layout :: header('Thêm sản phẩm mới', 'fas fa-plus')"></div>

    <!-- Alert Messages -->
    <div class="alert alert-error" th:if="${error}">
        <i class="fas fa-exclamation-circle"></i>
        <span th:text="${error}">Lỗi</span>
    </div>

    <!-- Form -->
    <div class="content-section">
        <form th:action="@{/admin/san-pham/them}" method="post">
            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 30px;">
                <!-- Left Column -->
                <div>
                    <h3 style="margin-bottom: 20px; color: #333;">Thông tin cơ bản</h3>

                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: #333;">
                            Tên sản phẩm <span style="color: #ff6b6b;">*</span>
                        </label>
                        <input type="text" name="ten" required
                               placeholder="Nhập tên sản phẩm"
                               style="width: 100%; padding: 10px 15px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                    </div>

                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: #333;">
                            Mã SKU
                        </label>
                        <input type="text" name="maSku"
                               placeholder="Mã sản phẩm (tùy chọn)"
                               style="width: 100%; padding: 10px 15px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                    </div>

                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: #333;">
                            Mô tả
                        </label>
                        <textarea name="moTa" rows="5"
                                  placeholder="Mô tả chi tiết về sản phẩm..."
                                  style="width: 100%; padding: 10px 15px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; resize: vertical;"></textarea>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                        <div>
                            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: #333;">
                                Giá (₫) <span style="color: #ff6b6b;">*</span>
                            </label>
                            <input type="number" name="gia" required min="0" step="1000"
                                   placeholder="30000"
                                   style="width: 100%; padding: 10px 15px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                        </div>

                        <div>
                            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: #333;">
                                Số lượng tồn <span style="color: #ff6b6b;">*</span>
                            </label>
                            <input type="number" name="soLuongTon" required min="0"
                                   placeholder="100"
                                   style="width: 100%; padding: 10px 15px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                        </div>
                    </div>

                    <!-- Danh mục - Checkbox nhiều lựa chọn -->
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 12px; font-weight: 500; color: #333;">
                            Danh mục
                        </label>
                        <div style="border: 1px solid #ddd; border-radius: 6px; padding: 15px; max-height: 200px; overflow-y: auto;">
                            <div th:each="dm : ${danhMucList}" style="margin-bottom: 10px;">
                                <label style="display: flex; align-items: center; cursor: pointer;">
                                    <input type="checkbox" name="danhMucIds" th:value="${dm.id}"
                                           style="margin-right: 8px; width: 16px; height: 16px;">
                                    <span th:text="${dm.ten}">Danh mục</span>
                                </label>
                            </div>
                        </div>
                        <small style="color: #999; font-size: 12px;">Có thể chọn nhiều danh mục</small>
                    </div>

                    <h3 style="margin: 30px 0 20px; color: #333;">Thông tin chi tiết</h3>

                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: #333;">
                            Nhà xuất bản
                        </label>
                        <input type="text" name="nhaXuatBan"
                               placeholder="Kim Đồng"
                               style="width: 100%; padding: 10px 15px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                        <div>
                            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: #333;">
                                Năm xuất bản
                            </label>
                            <input type="number" name="namXuatBan" min="1900" max="2100"
                                   placeholder="2024"
                                   style="width: 100%; padding: 10px 15px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                        </div>

                        <div>
                            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: #333;">
                                Số trang
                            </label>
                            <input type="number" name="soTrang" min="1"
                                   placeholder="200"
                                   style="width: 100%; padding: 10px 15px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                        </div>

                        <div>
                            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: #333;">
                                Trọng lượng (g)
                            </label>
                            <input type="number" name="trongLuong" min="0" step="0.01"
                                   placeholder="500"
                                   style="width: 100%; padding: 10px 15px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                        </div>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: #333;">
                            Ngôn ngữ
                        </label>
                        <input type="text" name="ngonNgu"
                               placeholder="Tiếng Việt"
                               style="width: 100%; padding: 10px 15px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                    </div>
                </div>

                <!-- Right Column -->
                <div>
                    <h3 style="margin-bottom: 20px; color: #333;">Hình ảnh</h3>

                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; color: #333;">
                            URL hình đại diện
                        </label>
                        <input type="url" name="anhDaiDien" id="anhDaiDien"
                               placeholder="https://example.com/image.jpg"
                               style="width: 100%; padding: 10px 15px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                        <small style="color: #999; font-size: 12px;">Nhập URL hình ảnh từ internet</small>
                    </div>

                    <div id="imagePreview" style="margin-top: 15px; display: none;">
                        <img id="previewImg" src="" alt="Preview"
                             style="width: 100%; border-radius: 8px; border: 2px solid #e0e0e0;">
                    </div>

                    <div style="padding: 15px; background: #f8f9fa; border-radius: 6px; margin-top: 20px;">
                        <p style="font-size: 13px; color: #666; margin-bottom: 10px;">
                            <strong>Hướng dẫn:</strong>
                        </p>
                        <ul style="font-size: 13px; color: #666; padding-left: 20px;">
                            <li>Upload ảnh lên trang như imgur.com</li>
                            <li>Copy URL ảnh và dán vào ô trên</li>
                            <li>Kích thước đề xuất: 300x400px</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Actions -->
            <div style="margin-top: 30px; padding-top: 20px; border-top: 2px solid #f0f0f0; display: flex; gap: 10px; justify-content: flex-end;">
                <a href="/admin/san-pham" class="btn btn-secondary">
                    <i class="fas fa-times"></i> Hủy
                </a>
                <button type="submit" class="btn btn-success">
                    <i class="fas fa-save"></i> Lưu sản phẩm
                </button>
            </div>
        </form>
    </div>
</main>

<script>
    // Preview image
    document.getElementById('anhDaiDien').addEventListener('input', function() {
        const url = this.value;
        const preview = document.getElementById('imagePreview');
        const img = document.getElementById('previewImg');

        if (url) {
            img.src = url;
            preview.style.display = 'block';

            img.onerror = function() {
                preview.style.display = 'none';
            };
        } else {
            preview.style.display = 'none';
        }
    });
</script>
</body>
</html>